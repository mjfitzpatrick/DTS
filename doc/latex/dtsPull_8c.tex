\hypertarget{dtsPull_8c}{
\section{dtsPull.c File Reference}
\label{dtsPull_8c}\index{dtsPull.c@{dtsPull.c}}
}
\hyperlink{structDTS}{DTS} Pull-Model Transfer Methods.  


{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$unistd.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$time.h$>$}\par
{\tt \#include $<$ctype.h$>$}\par
{\tt \#include $<$pthread.h$>$}\par
{\tt \#include $<$sys/socket.h$>$}\par
{\tt \#include $<$sys/time.h$>$}\par
{\tt \#include $<$netinet/in.h$>$}\par
{\tt \#include $<$arpa/inet.h$>$}\par
{\tt \#include $<$netdb.h$>$}\par
{\tt \#include $<$xmlrpc-c/base.h$>$}\par
{\tt \#include $<$xmlrpc-c/client.h$>$}\par
{\tt \#include $<$xmlrpc-c/server.h$>$}\par
{\tt \#include $<$xmlrpc-c/server\_\-abyss.h$>$}\par
{\tt \#include \char`\"{}dts.h\char`\"{}}\par
{\tt \#include \char`\"{}dtsUDT.h\char`\"{}}\par
{\tt \#include \char`\"{}dtsPSock.h\char`\"{}}\par
\subsection*{Functions}
\begin{CompactItemize}
\item 
\hypertarget{dtsPull_8c_f474314bf0c7298787f3b631466db62b}{
int \textbf{dts\_\-nullHandler} ()}
\label{dtsPull_8c_f474314bf0c7298787f3b631466db62b}

\item 
int \hyperlink{dtsPull_8c_610aae09a018aec201d73698a361b457}{dts\_\-xferPullFile} (void $\ast$data)
\begin{CompactList}\small\item\em Pull a file from the src to the dest machine. \item\end{CompactList}\item 
int \hyperlink{dtsPull_8c_18d097c124c1ed525294be0b1e7be6a1}{dts\_\-xferSendFile} (void $\ast$data)
\begin{CompactList}\small\item\em Send a file from the src to the dest machine. \item\end{CompactList}\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
\hypertarget{dtsPull_8c_99390fcf722f24689439904d1b546dce}{
\hyperlink{structDTS}{DTS} $\ast$ \textbf{dts}}
\label{dtsPull_8c_99390fcf722f24689439904d1b546dce}

\item 
\hypertarget{dtsPull_8c_e9c89e7ff1fbfe74ed32f3bb6b69193f}{
int \textbf{thread\_\-sem}}
\label{dtsPull_8c_e9c89e7ff1fbfe74ed32f3bb6b69193f}

\item 
\hypertarget{dtsPull_8c_4e3d0548c599124f2df64c499a8b0ee6}{
int \textbf{queue\_\-delay}}
\label{dtsPull_8c_4e3d0548c599124f2df64c499a8b0ee6}

\end{CompactItemize}


\label{_details}
\hypertarget{_details}{}
\subsection{Detailed Description}
\hyperlink{structDTS}{DTS} Pull-Model Transfer Methods. 

\hyperlink{structDTS}{DTS} Pull-Model Transfer Methods

The methods defined here are both the client and server-side code needed to implement the \char`\"{}pull\char`\"{} model of data transfer. In this mode, an RPC command is called to pull data from the source to the destination machine. The source machine acts as a server, opening the transfer sockets locally before sending a request to the remote machine to receive the file. Once the connection is established, transfer begins. The return status of this method then determines whether the transfer was successful.

A sequence diagram of the process would look something like:

Pull Model:

QMgr Host A Host B

(1) ----\mbox{[}Pull Msg\mbox{]} ----------------------------------$>$

(2) Socket setup

(3) $<$-----\mbox{[}FileSend Msg\mbox{]}------

(4) $<$=====\mbox{[}Data Transfer\mbox{]}=====$>$

(5) $<$----\mbox{[}Status Return\mbox{]}-------

The 'QMgr' is the Queue Manager which initiates the request on the local machine.

RPC Methods Implemented:

dts\_\-xferPullFile initiate Pull transfer of file (dest method) dts\_\-xferSendFile begin sending file (src method)

\begin{Desc}
\item[Author:]Mike Fitzpatrick, NOAO \end{Desc}
\begin{Desc}
\item[Date:]6/10/09 \end{Desc}


\subsection{Function Documentation}
\hypertarget{dtsPull_8c_610aae09a018aec201d73698a361b457}{
\index{dtsPull.c@{dtsPull.c}!dts\_\-xferPullFile@{dts\_\-xferPullFile}}
\index{dts\_\-xferPullFile@{dts\_\-xferPullFile}!dtsPull.c@{dtsPull.c}}
\subsubsection[{dts\_\-xferPullFile}]{\setlength{\rightskip}{0pt plus 5cm}int dts\_\-xferPullFile (void $\ast$ {\em data})}}
\label{dtsPull_8c_610aae09a018aec201d73698a361b457}


Pull a file from the src to the dest machine. 

DTS\_\-XFERPULL -- Pull a file from the src to the dest machine.

RPC Params: xferId S transfer id method S transfer method fileName S file name fileSize I file size nthreads I num of transfer threads to open srcPort I starting port number destHost S FQDN of destination machine destCmdURL S destination xmlrpc URI

RPC Returns: tsec I transfer time seconds tusec I transfer time micro-seconds status I transfer succeeded (0) or failed (1) ---------------------------------------------------------------------

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em data}]caller param data \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]status code \end{Desc}


References dts\_\-qstatNetEnd(), dts\_\-qstatNetStart(), dts\_\-queueFromPath(), dts\_\-queueNameFmt(), dts\_\-semGetVal(), dts\_\-semInit(), dts\_\-semRemove(), dtsErrLog(), dtsLog(), psCollectThreads(), psReceiveFile(), psSpawnThreads(), transferMB(), transferMb(), udtReceiveFile(), and udtSpawnThreads().\hypertarget{dtsPull_8c_18d097c124c1ed525294be0b1e7be6a1}{
\index{dtsPull.c@{dtsPull.c}!dts\_\-xferSendFile@{dts\_\-xferSendFile}}
\index{dts\_\-xferSendFile@{dts\_\-xferSendFile}!dtsPull.c@{dtsPull.c}}
\subsubsection[{dts\_\-xferSendFile}]{\setlength{\rightskip}{0pt plus 5cm}int dts\_\-xferSendFile (void $\ast$ {\em data})}}
\label{dtsPull_8c_18d097c124c1ed525294be0b1e7be6a1}


Send a file from the src to the dest machine. 

DTS\_\-XFERSENDFILE -- Send a file to the dest machine.

RPC Params: xferId S transfer id fileName S file name fileSize I file size nthreads I num of transfer threads to open srcPort I starting port number srcIP S IP address of caller (string)

RPC Return: 0 transfer succeeded 1 transfer failed ---------------------------------------------------------------------

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em data}]caller param data \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]status code \end{Desc}


References dts\_\-queueFromPath(), dts\_\-queueNameFmt(), dtsLog(), psCollectThreads(), psSendFile(), psSpawnThreads(), transferMB(), transferMb(), udtSendFile(), and udtSpawnThreads().